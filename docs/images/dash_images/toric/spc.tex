%use lualatex to build

\RequirePackage{pdfmanagement-testphase}
\DeclareDocumentMetadata{}

\documentclass[aps,prb,12pt,tightenlines,notitlepage]{revtex4-2}

\usepackage{pstricks}
\usepackage{pst-solides3d}
\nofiles
\pagestyle{empty}

\begin{document}
\psset{unit=0.25}
% regular QHP code 
%\framebox{
 \begin{pspicture*}(-16,-23)(12,2)
  \psset{viewpoint=30 40 80,Decran=120,linewidth=0.2pt}
  \psset{linecolor=red}
%  \multido{\rx=-1.5+2.0}{6}{
%  }
%logical
    \psSolid[object=cylindre,h=1,r=0.5,RotY=90,%
    fillcolor=red!50,ngrid=2 16](-1.5,0,0)%
    \psSolid[object=cylindre,h=1,r=0.5,RotY=90,
    fillcolor=red!50,ngrid=2 16](0.5,0,0)%
    \psSolid[object=cylindre,h=1,r=0.5,RotY=90,opacity=0.2,%
    fillcolor=red!50,ngrid=2 16](2.5,0,0)%
    \psSolid[object=cylindre,h=1,r=0.5,RotY=90,
    fillcolor=red!50,ngrid=2 16](4.5,0,0)%
    \psSolid[object=cylindre,h=1,r=0.5,RotY=90,opacity=0.2,%%
    fillcolor=red!50,ngrid=2 16](6.5,0,0)%
    \psSolid[object=cylindre,h=1,r=0.5,RotY=90,opacity=0.2,%
    fillcolor=red!50,ngrid=2 16](8.5,0,0)%
    \psSolid[object=cylindre,h=1,r=0.5,RotY=90,
    fillcolor=red!50,ngrid=2 16](10.5,0,0)%

%logical
  \psset{linecolor=blue}
%  \multido{\ry=0+2}{7}{%
    \psSolid[object=cube,a=2,ngrid=1,action=draw*,opacity=0.5,%
    rm=0 1 3 4 5,fillcolor=blue!50,incolor=blue!50,hollow](12,0,0)%
    \psSolid[object=cube,a=2,ngrid=1,action=draw*,opacity=0.1,%
    rm=0 1 3 4 5,fillcolor=blue!50,incolor=blue!50,hollow](12,2,0)%
    \psSolid[object=cube,a=2,ngrid=1,action=draw*,opacity=0.1,%
    rm=0 1 3 4 5,fillcolor=blue!50,incolor=blue!50,hollow](12,4,0)%
    \psSolid[object=cube,a=2,ngrid=1,action=draw*,opacity=0.5,%
    rm=0 1 3 4 5,fillcolor=blue!50,incolor=blue!50,hollow](12,6,0)%
    \psSolid[object=cube,a=2,ngrid=1,action=draw*,opacity=0.1,%
    rm=0 1 3 4 5,fillcolor=blue!50,incolor=blue!50,hollow](12,8,0)%
    \psSolid[object=cube,a=2,ngrid=1,action=draw*,opacity=0.5,%
    rm=0 1 3 4 5,fillcolor=blue!50,incolor=blue!50,hollow](12,10,0)%
    \psSolid[object=cube,a=2,ngrid=1,action=draw*,opacity=0.5,%
    rm=0 1 3 4 5,fillcolor=blue!50,incolor=blue!50,hollow](12,12,0)%
 % }%
 
 %check
  \psset{linecolor=red}
 \psSolid[object=cylindre,h=0.5,r=0.5,RotY=90,
fillcolor=red!50,ngrid=1 16](11,0,0)

\psSolid[object=cylindre,h=1,r=0.5,RotY=90,opacity=0.2,
 fillcolor=red!50,ngrid=2 16](0.5,8,0)
\psSolid[object=cylindre,h=1,r=0.5,RotY=90,
 fillcolor=red!50,ngrid=2 16](0.5,4,0)

\psSolid[object=cylindre,h=1,r=0.5,RotY=90,
fillcolor=red!50,ngrid=2 16](0.5,10,0)
%  
%   \psSolid[object=cylindre,h=1,r=0.5,RotX=90,
%  fillcolor=red!50,ngrid=2 16](0,5.5,0)
%  \psSolid[object=cylindre,h=1.0,r=0.5,RotX=90,
%  fillcolor=red!50,ngrid=2 16](2,5.5,0)
%  \psSolid[object=cylindre,h=1.0,r=0.5,RotX=90,opacity=0.2,
%  fillcolor=red!50,ngrid=2 16](4,5.5,0)
%  \psSolid[object=cylindre,h=1.0,r=0.5,RotX=90,
%  fillcolor=red!50,ngrid=2 16](6,5.5,0)  

  \psset{linecolor=black}
    \psSolid[object=cube,a=2,ngrid=1,action=draw*,opacity=0.5,%
    rm=0 1 3 4 5,fillcolor=blue!50,incolor=blue!50,hollow](4,12,0)
    \psSolid[object=cube,a=2,ngrid=1,action=draw*,opacity=0.1,%
    rm=0 1 3 4 5,fillcolor=blue!50,incolor=blue!50,hollow](6,12,0)
%    \psSolid[object=cube,a=2,ngrid=1,action=draw*,opacity=0.5,%
%    rm=0 2 3 4 5,fillcolor=blue!50,incolor=blue!50,hollow](8,6,0)
%    \psSolid[object=cube,a=2,ngrid=1,action=draw*,opacity=0.1,%
%    rm=0 2 3 4 5,fillcolor=blue!50,incolor=blue!50,hollow](8,8,0)
  \psSolid[object=cube,a=2,ngrid=1,action=draw*,opacity=0.5,%
  rm=0 1 3   5,fillcolor=blue!50,incolor=blue!50,hollow](8,12,0)
  
  \psset{linecolor=red}
  \psSolid[object=cylindre,h=1,r=0.5,RotY=90,
  fillcolor=red!50,ngrid=2 16](0.5,6,0)
%  \psSolid[object=cylindre,h=0.5,r=0.5,RotX=90,
%  fillcolor=red!50,ngrid=1 16](2,7.5,0)

  \psset{linecolor=gray!50,opacity=0.3}
  \multido{\rx=0+2}{6}{%
    \multido{\ry=0+2}{7}{%
      \psSolid[object=cube,a=2,ngrid=1,rm=0 1 3   5,action=draw](\rx,\ry,0)%
    }
  }
% \multips(0,0)(2,0){8}{\face}
\end{pspicture*} 
%}
\end{document}
